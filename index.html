<!DOCTYPE html><html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Coin Kar/Zarar Hesaplama</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      border: 2px solid #ccc;
      border-radius: 10px;
      background: #f7f7f7;
    }
    h2 {
      text-align: center;
    }
    label {
      display: block;
      margin: 10px 0 5px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
    }
    button {
      width: 100%;
      padding: 10px;
      font-weight: bold;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .sonuc {
      margin-top: 20px;
      font-size: 16px;
      font-weight: bold;
    }
    ul { padding-left: 20px; }
  </style>
</head>
<body>
  <h2>Coin Alım-Satım Takip ve Kar/Zarar Hesaplama</h2>  <h3>Yeni Alış Ekle</h3>
  <label>Coin Adı:</label>
  <input type="text" id="coin" placeholder="Örn: WIF"><label>Alış Fiyatı (₺):</label> <input type="number" id="alis" step="0.0001">

<label>Adet:</label> <input type="number" id="adet" step="0.0001">

<button onclick="alisEkle()">Alışı Kaydet</button>

  <h3>Satış Yap</h3>
  <label>Coin Adı:</label>
  <input type="text" id="satisCoin" placeholder="Örn: WIF"><label>Satış Fiyatı (₺):</label> <input type="number" id="satisFiyat" step="0.0001">

<label>Satılan Adet:</label> <input type="number" id="satisAdet" step="0.0001">

<button onclick="satisYap()">Satışı Hesapla</button>

  <div class="sonuc" id="sonuc"></div>  <h3>Alış Geçmişi</h3>
  <ul id="gecmis"></ul>  <script>
    let alislar = JSON.parse(localStorage.getItem('alislar') || '[]');

    function guncelleGecmis() {
      const gecmis = document.getElementById('gecmis');
      gecmis.innerHTML = '';
      alislar.forEach((a, i) => {
        const li = document.createElement('li');
        li.textContent = `${a.coin.toUpperCase()} | ${a.adet} adet | ${a.fiyat}₺`; 
        gecmis.appendChild(li);
      });
    }

    function alisEkle() {
      const coin = document.getElementById('coin').value.trim();
      const fiyat = parseFloat(document.getElementById('alis').value);
      const adet = parseFloat(document.getElementById('adet').value);
      if (!coin || isNaN(fiyat) || isNaN(adet)) {
        alert("Tüm alış bilgilerini doğru girin.");
        return;
      }
      alislar.push({ coin, fiyat, adet });
      localStorage.setItem('alislar', JSON.stringify(alislar));
      guncelleGecmis();
      document.getElementById('coin').value = '';
      document.getElementById('alis').value = '';
      document.getElementById('adet').value = '';
    }

    function satisYap() {
      const coin = document.getElementById('satisCoin').value.trim();
      const satisFiyat = parseFloat(document.getElementById('satisFiyat').value);
      let satisAdet = parseFloat(document.getElementById('satisAdet').value);

      if (!coin || isNaN(satisFiyat) || isNaN(satisAdet)) {
        alert("Tüm satış bilgilerini doğru girin.");
        return;
      }

      let kalanAdet = satisAdet;
      let kar = 0;
      let yeniAlislar = [];

      for (let i = 0; i < alislar.length; i++) {
        let a = alislar[i];
        if (a.coin.toUpperCase() !== coin.toUpperCase()) {
          yeniAlislar.push(a);
          continue;
        }

        if (kalanAdet <= 0) {
          yeniAlislar.push(a);
          continue;
        }

        if (a.adet <= kalanAdet) {
          kar += (satisFiyat - a.fiyat) * a.adet;
          kalanAdet -= a.adet;
        } else {
          kar += (satisFiyat - a.fiyat) * kalanAdet;
          a.adet -= kalanAdet;
          yeniAlislar.push(a);
          kalanAdet = 0;
        }
      }

      localStorage.setItem('alislar', JSON.stringify(yeniAlislar));
      alislar = yeniAlislar;
      guncelleGecmis();

      const sonuc = document.getElementById('sonuc');
      if (kalanAdet > 0) {
        sonuc.innerText = `Yetersiz adet: ${kalanAdet} adet coin bulunamadı.`;
      } else {
        sonuc.innerText = `Toplam Kar/Zarar: ${kar.toFixed(2)}₺`;
      }
    }

    guncelleGecmis();
  </script></body>
</html>